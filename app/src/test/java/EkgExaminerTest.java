import com.iuridiniz.checkmyecg.examiners.EkgExaminer;

import org.apache.commons.math3.stat.StatUtils;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;

import java.util.LinkedList;

/**
 * Created by iuri on 01/12/15.
 */

public class EkgExaminerTest {

    /* file: test (22).jpg -- V4, first two signals */
    static final double[] REAL_SIGNAL_X = {0.0, 0.00266666666667, 0.00533333333333, 0.008, 0.0106666666667, 0.0133333333333, 0.016, 0.0186666666667, 0.0213333333333, 0.024, 0.0266666666667, 0.0293333333333, 0.032, 0.0346666666667, 0.0373333333333, 0.04, 0.0426666666667, 0.0453333333333, 0.048, 0.0506666666667, 0.0533333333333, 0.056, 0.0586666666667, 0.0613333333333, 0.064, 0.0666666666667, 0.0693333333333, 0.072, 0.0746666666667, 0.0773333333333, 0.08, 0.0826666666667, 0.0853333333333, 0.088, 0.0906666666667, 0.0933333333333, 0.096, 0.0986666666667, 0.101333333333, 0.104, 0.106666666667, 0.109333333333, 0.112, 0.114666666667, 0.117333333333, 0.12, 0.122666666667, 0.125333333333, 0.128, 0.130666666667, 0.133333333333, 0.136, 0.138666666667, 0.141333333333, 0.144, 0.146666666667, 0.149333333333, 0.152, 0.154666666667, 0.157333333333, 0.16, 0.162666666667, 0.165333333333, 0.168, 0.170666666667, 0.173333333333, 0.176, 0.178666666667, 0.181333333333, 0.184, 0.186666666667, 0.189333333333, 0.192, 0.194666666667, 0.197333333333, 0.2, 0.202666666667, 0.205333333333, 0.208, 0.210666666667, 0.213333333333, 0.216, 0.218666666667, 0.221333333333, 0.224, 0.226666666667, 0.229333333333, 0.232, 0.234666666667, 0.237333333333, 0.24, 0.242666666667, 0.245333333333, 0.248, 0.250666666667, 0.253333333333, 0.256, 0.258666666667, 0.261333333333, 0.264, 0.266666666667, 0.269333333333, 0.272, 0.274666666667, 0.277333333333, 0.28, 0.282666666667, 0.285333333333, 0.288, 0.290666666667, 0.293333333333, 0.296, 0.298666666667, 0.301333333333, 0.304, 0.306666666667, 0.309333333333, 0.312, 0.314666666667, 0.317333333333, 0.32, 0.322666666667, 0.325333333333, 0.328, 0.330666666667, 0.333333333333, 0.336, 0.338666666667, 0.341333333333, 0.344, 0.346666666667, 0.349333333333, 0.352, 0.354666666667, 0.357333333333, 0.36, 0.362666666667, 0.365333333333, 0.368, 0.370666666667, 0.373333333333, 0.376, 0.378666666667, 0.381333333333, 0.384, 0.386666666667, 0.389333333333, 0.392, 0.394666666667, 0.397333333333, 0.4, 0.402666666667, 0.405333333333, 0.408, 0.410666666667, 0.413333333333, 0.416, 0.418666666667, 0.421333333333, 0.424, 0.426666666667, 0.429333333333, 0.432, 0.434666666667, 0.437333333333, 0.44, 0.442666666667, 0.445333333333, 0.448, 0.450666666667, 0.453333333333, 0.456, 0.458666666667, 0.461333333333, 0.464, 0.466666666667, 0.469333333333, 0.472, 0.474666666667, 0.477333333333, 0.48, 0.482666666667, 0.485333333333, 0.488, 0.490666666667, 0.493333333333, 0.496, 0.498666666667, 0.501333333333, 0.504, 0.506666666667, 0.509333333333, 0.512, 0.514666666667, 0.517333333333, 0.52, 0.522666666667, 0.525333333333, 0.528, 0.530666666667, 0.533333333333, 0.536, 0.538666666667, 0.541333333333, 0.544, 0.546666666667, 0.549333333333, 0.552, 0.554666666667, 0.557333333333, 0.56, 0.562666666667, 0.565333333333, 0.568, 0.570666666667, 0.573333333333, 0.576, 0.578666666667, 0.581333333333, 0.584, 0.586666666667, 0.589333333333, 0.592, 0.594666666667, 0.597333333333, 0.6, 0.602666666667, 0.605333333333, 0.608, 0.610666666667, 0.613333333333, 0.616, 0.618666666667, 0.621333333333, 0.624, 0.626666666667, 0.629333333333, 0.632, 0.634666666667, 0.637333333333, 0.64, 0.642666666667, 0.645333333333, 0.648, 0.650666666667, 0.653333333333, 0.656, 0.658666666667, 0.661333333333, 0.664, 0.666666666667, 0.669333333333, 0.672, 0.674666666667, 0.677333333333, 0.68, 0.682666666667, 0.685333333333, 0.688, 0.690666666667, 0.693333333333, 0.696, 0.698666666667, 0.701333333333, 0.704, 0.706666666667, 0.709333333333, 0.712, 0.714666666667, 0.717333333333, 0.72, 0.722666666667, 0.725333333333, 0.728, 0.730666666667, 0.733333333333, 0.736, 0.738666666667, 0.741333333333, 0.744, 0.746666666667, 0.749333333333, 0.752, 0.754666666667, 0.757333333333, 0.76, 0.762666666667, 0.765333333333, 0.768, 0.770666666667, 0.773333333333, 0.776, 0.778666666667, 0.781333333333, 0.784, 0.786666666667, 0.789333333333, 0.792, 0.794666666667, 0.797333333333, 0.8, 0.802666666667, 0.805333333333, 0.808, 0.810666666667, 0.813333333333, 0.816, 0.818666666667, 0.821333333333, 0.824, 0.826666666667, 0.829333333333, 0.832, 0.834666666667, 0.837333333333, 0.84, 0.842666666667, 0.845333333333, 0.848, 0.850666666667, 0.853333333333, 0.856, 0.858666666667, 0.861333333333, 0.864, 0.866666666667, 0.869333333333, 0.872, 0.874666666667, 0.877333333333, 0.88, 0.882666666667, 0.885333333333, 0.888, 0.890666666667, 0.893333333333, 0.896, 0.898666666667, 0.901333333333, 0.904, 0.906666666667, 0.909333333333, 0.912, 0.914666666667, 0.917333333333, 0.92, 0.922666666667, 0.925333333333, 0.928, 0.930666666667, 0.933333333333, 0.936, 0.938666666667, 0.941333333333, 0.944, 0.946666666667, 0.949333333333, 0.952, 0.954666666667, 0.957333333333, 0.96, 0.962666666667, 0.965333333333, 0.968, 0.970666666667, 0.973333333333, 0.976, 0.978666666667, 0.981333333333, 0.984, 0.986666666667, 0.989333333333, 0.992, 0.994666666667, 0.997333333333, 1.0, 1.00266666667, 1.00533333333, 1.008, 1.01066666667, 1.01333333333, 1.016, 1.01866666667, 1.02133333333, 1.024, 1.02666666667, 1.02933333333, 1.032, 1.03466666667, 1.03733333333, 1.04, 1.04266666667, 1.04533333333, 1.048, 1.05066666667, 1.05333333333, 1.056, 1.05866666667, 1.06133333333, 1.064, 1.06666666667, 1.06933333333, 1.072, 1.07466666667, 1.07733333333, 1.08, 1.08266666667, 1.08533333333, 1.088, 1.09066666667, 1.09333333333, 1.096, 1.09866666667, 1.10133333333, 1.104, 1.10666666667, 1.10933333333, 1.112, 1.11466666667, 1.11733333333, 1.12, 1.12266666667, 1.12533333333, 1.128, 1.13066666667, 1.13333333333, 1.136, 1.13866666667, 1.14133333333, 1.144, 1.14666666667, 1.14933333333, 1.152, 1.15466666667, 1.15733333333, 1.16, 1.16266666667, 1.16533333333, 1.168, 1.17066666667, 1.17333333333, 1.176, 1.17866666667, 1.18133333333, 1.184, 1.18666666667, 1.18933333333, 1.192, 1.19466666667, 1.19733333333, 1.2, 1.20266666667, 1.20533333333, 1.208, 1.21066666667, 1.21333333333, 1.216, 1.21866666667, 1.22133333333, 1.224, 1.22666666667, 1.22933333333, 1.232, 1.23466666667, 1.23733333333, 1.24, 1.24266666667, 1.24533333333, 1.248, 1.25066666667, 1.25333333333, 1.256, 1.25866666667, 1.26133333333, 1.264, 1.26666666667, 1.26933333333, 1.272, 1.27466666667, 1.27733333333, 1.28, 1.28266666667, 1.28533333333, 1.288, 1.29066666667, 1.29333333333, 1.296, 1.29866666667, 1.30133333333, 1.304, 1.30666666667, 1.30933333333, 1.312, 1.31466666667, 1.31733333333, 1.32, 1.32266666667, 1.32533333333, 1.328, 1.33066666667, 1.33333333333, 1.336, 1.33866666667, 1.34133333333, 1.344, 1.34666666667, 1.34933333333, 1.352, 1.35466666667, 1.35733333333, 1.36, 1.36266666667, 1.36533333333, 1.368, 1.37066666667, 1.37333333333, 1.376, 1.37866666667, 1.38133333333, 1.384, 1.38666666667, 1.38933333333, 1.392, 1.39466666667, 1.39733333333, 1.4, 1.40266666667, 1.40533333333, 1.408, 1.41066666667, 1.41333333333, 1.416, 1.41866666667, 1.42133333333, 1.424, 1.42666666667, 1.42933333333, 1.432, 1.43466666667, 1.43733333333, 1.44, 1.44266666667, 1.44533333333, 1.448, 1.45066666667, 1.45333333333, 1.456, 1.45866666667, 1.46133333333, 1.464, 1.46666666667, 1.46933333333, 1.472, 1.47466666667, 1.47733333333, 1.48, 1.48266666667, 1.48533333333, 1.488, 1.49066666667, 1.49333333333, 1.496, 1.49866666667, 1.50133333333, 1.504, 1.50666666667, 1.50933333333, 1.512, 1.51466666667, 1.51733333333, 1.52, 1.52266666667, 1.52533333333, 1.528, 1.53066666667, 1.53333333333, 1.536, 1.53866666667, 1.54133333333, 1.544, 1.54666666667, 1.54933333333, 1.552, 1.55466666667, 1.55733333333, 1.56, 1.56266666667, 1.56533333333, 1.568, 1.57066666667, 1.57333333333, 1.576, 1.57866666667, 1.58133333333, 1.584, 1.58666666667, 1.58933333333, 1.592, 1.59466666667, 1.59733333333, 1.6, 1.60266666667, 1.60533333333, 1.608, 1.61066666667, 1.61333333333, 1.616, 1.61866666667, 1.62133333333, 1.624, 1.62666666667, 1.62933333333, 1.632, 1.63466666667, 1.63733333333, 1.64, 1.64266666667, 1.64533333333, 1.648, 1.65066666667, 1.65333333333, 1.656, 1.65866666667, 1.66133333333, 1.664, 1.66666666667, 1.66933333333, 1.672, 1.67466666667, 1.67733333333, 1.68, 1.68266666667, 1.68533333333, 1.688, 1.69066666667, 1.69333333333, 1.696, 1.69866666667, 1.70133333333, 1.704, 1.70666666667, 1.70933333333, 1.712, 1.71466666667, 1.71733333333, 1.72, 1.72266666667, 1.72533333333, 1.728, 1.73066666667, 1.73333333333, 1.736, 1.73866666667, 1.74133333333, 1.744, 1.74666666667, 1.74933333333, 1.752, 1.75466666667, 1.75733333333, 1.76, 1.76266666667, 1.76533333333, 1.768, 1.77066666667, 1.77333333333, 1.776, 1.77866666667, 1.78133333333, 1.784, 1.78666666667, 1.78933333333, 1.792, 1.79466666667, 1.79733333333, 1.8, 1.80266666667, 1.80533333333, 1.808, 1.81066666667, 1.81333333333, 1.816, 1.81866666667, 1.82133333333, 1.824, 1.82666666667, 1.82933333333, 1.832,};
    static final double[] REAL_SIGNAL_Y = {1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.16666666667, 1.16, 1.16, 1.16, 1.16, 1.16666666667, 1.17333333333, 1.17333333333, 1.17333333333, 1.18, 1.18, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.19333333333, 1.2, 1.2, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.22, 1.22, 1.22, 1.22666666667, 1.22666666667, 1.22666666667, 1.22666666667, 1.22666666667, 1.22666666667, 1.22666666667, 1.22, 1.21333333333, 1.20666666667, 1.20666666667, 1.20666666667, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.2, 1.2, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.18666666667, 1.19333333333, 1.2, 1.2, 1.21333333333, 1.24666666667, 1.29333333333, 1.35333333333, 1.48, 1.66666666667, 1.83333333333, 1.99333333333, 2.1, 2.26666666667, 2.26666666667, 2.26666666667, 2.26666666667, 2.26666666667, 2.5, 2.46, 2.38666666667, 2.27333333333, 2.12666666667, 1.92, 1.72666666667, 1.32666666667, 1.32666666667, 1.18666666667, 0.94, 0.88, 0.833333333333, 0.833333333333, 0.84, 0.86, 0.9, 0.933333333333, 0.953333333333, 1.0, 1.04666666667, 1.06, 1.08666666667, 1.1, 1.11333333333, 1.12, 1.13333333333, 1.13333333333, 1.14, 1.14666666667, 1.15333333333, 1.16, 1.16, 1.16, 1.16666666667, 1.16666666667, 1.16666666667, 1.17333333333, 1.17333333333, 1.17333333333, 1.18, 1.18, 1.18, 1.18666666667, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.2, 1.2, 1.2, 1.2, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.21333333333, 1.22, 1.22666666667, 1.23333333333, 1.24, 1.24666666667, 1.24666666667, 1.24666666667, 1.24666666667, 1.24666666667, 1.25333333333, 1.26, 1.26, 1.26666666667, 1.26666666667, 1.27333333333, 1.27333333333, 1.27333333333, 1.28, 1.28666666667, 1.3, 1.3, 1.31333333333, 1.31333333333, 1.32666666667, 1.33333333333, 1.34, 1.35333333333, 1.36, 1.37333333333, 1.37333333333, 1.38666666667, 1.4, 1.41333333333, 1.42, 1.43333333333, 1.44, 1.44666666667, 1.47333333333, 1.48666666667, 1.5, 1.51333333333, 1.52666666667, 1.54666666667, 1.55333333333, 1.56666666667, 1.58, 1.58666666667, 1.60666666667, 1.60666666667, 1.61333333333, 1.62666666667, 1.63333333333, 1.64, 1.64666666667, 1.64666666667, 1.64666666667, 1.64666666667, 1.64666666667, 1.64666666667, 1.64, 1.64, 1.62666666667, 1.61333333333, 1.6, 1.58666666667, 1.57333333333, 1.56, 1.54, 1.52666666667, 1.51333333333, 1.5, 1.48, 1.46, 1.43333333333, 1.42, 1.4, 1.38, 1.36, 1.34, 1.32666666667, 1.30666666667, 1.29333333333, 1.27333333333, 1.26666666667, 1.25333333333, 1.22666666667, 1.22, 1.21333333333, 1.20666666667, 1.19333333333, 1.18666666667, 1.18, 1.17333333333, 1.16666666667, 1.16, 1.14666666667, 1.14, 1.13333333333, 1.12666666667, 1.12666666667, 1.12666666667, 1.12, 1.12, 1.12, 1.11333333333, 1.11333333333, 1.11333333333, 1.11333333333, 1.10666666667, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.10666666667, 1.10666666667, 1.10666666667, 1.11333333333, 1.12, 1.12, 1.12, 1.12, 1.12666666667, 1.12666666667, 1.12666666667, 1.12666666667, 1.13333333333, 1.13333333333, 1.14, 1.14, 1.14666666667, 1.14666666667, 1.16, 1.16, 1.16666666667, 1.16666666667, 1.17333333333, 1.17333333333, 1.17333333333, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18666666667, 1.18, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.18666666667, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.17333333333, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18666666667, 1.18666666667, 1.32666666667, 1.32666666667, 1.31333333333, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.19333333333, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.18666666667, 1.19333333333, 1.19333333333, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.20666666667, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.22, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.21333333333, 1.22, 1.22, 1.22, 1.22666666667, 1.22666666667, 1.23333333333, 1.23333333333, 1.23333333333, 1.23333333333, 1.24, 1.24, 1.24, 1.24666666667, 1.24, 1.24, 1.24, 1.24, 1.24, 1.24, 1.24, 1.24, 1.24, 1.24666666667, 1.25333333333, 1.25333333333, 1.25333333333, 1.25333333333, 1.26, 1.26, 1.26666666667, 1.26666666667, 1.26666666667, 1.26666666667, 1.27333333333, 1.27333333333, 1.27333333333, 1.27333333333, 1.28, 1.28, 1.28, 1.28, 1.28666666667, 1.28666666667, 1.28666666667, 1.29333333333, 1.29333333333, 1.29333333333, 1.29333333333, 1.29333333333, 1.29333333333, 1.28666666667, 1.28, 1.28, 1.28, 1.28, 1.27333333333, 1.27333333333, 1.27333333333, 1.26666666667, 1.26666666667, 1.26666666667, 1.26666666667, 1.26666666667, 1.26666666667, 1.27333333333, 1.27333333333, 1.27333333333, 1.27333333333, 1.27333333333, 1.27333333333, 1.27333333333, 1.27333333333, 1.26666666667, 1.26666666667, 1.26, 1.26, 1.26, 1.25333333333, 1.25333333333, 1.26, 1.26, 1.26, 1.27333333333, 1.28666666667, 1.32, 1.32666666667, 1.34666666667, 1.47333333333, 1.58, 1.82, 2.04, 2.46, 2.64666666667, 2.68, 2.66666666667, 2.59333333333, 2.54666666667, 2.49333333333, 2.39333333333, 2.16, 2.09333333333, 1.90666666667, 1.75333333333, 1.58666666667, 1.43333333333, 1.28666666667, 1.16, 0.973333333333, 0.94, 0.886666666667, 0.88, 0.886666666667, 0.92, 0.953333333333, 1.0, 1.05333333333, 1.08666666667, 1.14666666667, 1.15333333333, 1.18, 1.18666666667, 1.20666666667, 1.21333333333, 1.22, 1.22, 1.22666666667, 1.23333333333, 1.23333333333, 1.24, 1.24, 1.24666666667, 1.25333333333, 1.25333333333, 1.25333333333, 1.26, 1.26, 1.26666666667, 1.26666666667, 1.26666666667, 1.27333333333, 1.28, 1.28, 1.28, 1.28, 1.28, 1.28, 1.28, 1.28, 1.28, 1.28666666667, 1.28666666667, 1.29333333333, 1.29333333333, 1.29333333333, 1.29333333333, 1.29333333333, 1.3, 1.30666666667, 1.30666666667, 1.31333333333, 1.31333333333, 1.32, 1.32, 1.32, 1.32666666667, 1.32666666667, 1.33333333333, 1.33333333333, 1.33333333333, 1.34, 1.34666666667, 1.34666666667, 1.35333333333, 1.35333333333, 1.36, 1.36666666667, 1.37333333333, 1.38, 1.38666666667, 1.39333333333, 1.39333333333, 1.40666666667, 1.41333333333, 1.42, 1.42666666667, 1.43333333333, 1.44, 1.44, 1.44666666667, 1.45333333333, 1.46666666667, 1.47333333333, 1.48, 1.5, 1.50666666667, 1.52666666667, 1.53333333333, 1.54666666667, 1.56, 1.57333333333, 1.59333333333, 1.6, 1.61333333333, 1.62666666667, 1.64, 1.65333333333, 1.66, 1.67333333333, 1.69333333333, 1.7, 1.70666666667, 1.71333333333, 1.72, 1.72, 1.72, 1.72, 1.72, 1.71333333333, 1.71333333333, 1.71333333333, 1.70666666667, 1.69333333333, 1.67333333333, 1.67333333333, 1.66666666667, 1.65333333333, 1.64, 1.60666666667, 1.6, 1.57333333333, 1.56666666667, 1.52666666667, 1.51333333333, 1.49333333333, 1.47333333333, 1.46, 1.44666666667, 1.43333333333, 1.4, 1.38666666667, 1.38, 1.36, 1.34666666667, 1.33333333333, 1.30666666667, 1.3, 1.28666666667, 1.28, 1.26666666667, 1.26, 1.25333333333, 1.24666666667, 1.23333333333, 1.23333333333, 1.23333333333, 1.22666666667, 1.22, 1.22, 1.21333333333, 1.21333333333, 1.20666666667, 1.20666666667, 1.2, 1.2, 1.2, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333, 1.19333333333,};
    /* file: test (2).jpg -- V5, skip first, four signals */
    static final double[] REAL_SIGNAL2_X = { 0.0, 0.002, 0.004, 0.006, 0.008, 0.01, 0.012, 0.014, 0.016, 0.018000000000000002, 0.02, 0.022, 0.024, 0.026000000000000002, 0.028, 0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054, 0.056, 0.058, 0.06, 0.062, 0.064, 0.066, 0.068, 0.07, 0.07200000000000001, 0.074, 0.076, 0.078, 0.08, 0.082, 0.084, 0.08600000000000001, 0.088, 0.09, 0.092, 0.094, 0.096, 0.098, 0.1, 0.10200000000000001, 0.10400000000000001, 0.106, 0.108, 0.11, 0.112, 0.114, 0.116, 0.11800000000000001, 0.12, 0.122, 0.124, 0.126, 0.128, 0.13, 0.132, 0.134, 0.136, 0.138, 0.14, 0.14200000000000002, 0.14400000000000002, 0.146, 0.148, 0.15, 0.152, 0.154, 0.156, 0.158, 0.16, 0.162, 0.164, 0.166, 0.168, 0.17, 0.17200000000000001, 0.17400000000000002, 0.176, 0.178, 0.18, 0.182, 0.184, 0.186, 0.188, 0.19, 0.192, 0.194, 0.196, 0.198, 0.2, 0.202, 0.20400000000000001, 0.20600000000000002, 0.20800000000000002, 0.21, 0.212, 0.214, 0.216, 0.218, 0.22, 0.222, 0.224, 0.226, 0.228, 0.23, 0.232, 0.234, 0.23600000000000002, 0.23800000000000002, 0.24, 0.242, 0.244, 0.246, 0.248, 0.25, 0.252, 0.254, 0.256, 0.258, 0.26, 0.262, 0.264, 0.266, 0.268, 0.27, 0.272, 0.274, 0.276, 0.278, 0.28, 0.28200000000000003, 0.28400000000000003, 0.28600000000000003, 0.28800000000000003, 0.29, 0.292, 0.294, 0.296, 0.298, 0.3, 0.302, 0.304, 0.306, 0.308, 0.31, 0.312, 0.314, 0.316, 0.318, 0.32, 0.322, 0.324, 0.326, 0.328, 0.33, 0.332, 0.334, 0.336, 0.338, 0.34, 0.342, 0.34400000000000003, 0.34600000000000003, 0.34800000000000003, 0.35000000000000003, 0.352, 0.354, 0.356, 0.358, 0.36, 0.362, 0.364, 0.366, 0.368, 0.37, 0.372, 0.374, 0.376, 0.378, 0.38, 0.382, 0.384, 0.386, 0.388, 0.39, 0.392, 0.394, 0.396, 0.398, 0.4, 0.402, 0.404, 0.406, 0.40800000000000003, 0.41000000000000003, 0.41200000000000003, 0.41400000000000003, 0.41600000000000004, 0.418, 0.42, 0.422, 0.424, 0.426, 0.428, 0.43, 0.432, 0.434, 0.436, 0.438, 0.44, 0.442, 0.444, 0.446, 0.448, 0.45, 0.452, 0.454, 0.456, 0.458, 0.46, 0.462, 0.464, 0.466, 0.468, 0.47000000000000003, 0.47200000000000003, 0.47400000000000003, 0.47600000000000003, 0.47800000000000004, 0.48, 0.482, 0.484, 0.486, 0.488, 0.49, 0.492, 0.494, 0.496, 0.498, 0.5, 0.502, 0.504, 0.506, 0.508, 0.51, 0.512, 0.514, 0.516, 0.518, 0.52, 0.522, 0.524, 0.526, 0.528, 0.53, 0.532, 0.534, 0.536, 0.538, 0.54, 0.542, 0.544, 0.546, 0.548, 0.55, 0.552, 0.554, 0.556, 0.558, 0.56, 0.562, 0.5640000000000001, 0.5660000000000001, 0.5680000000000001, 0.5700000000000001, 0.5720000000000001, 0.5740000000000001, 0.5760000000000001, 0.578, 0.58, 0.582, 0.584, 0.586, 0.588, 0.59, 0.592, 0.594, 0.596, 0.598, 0.6, 0.602, 0.604, 0.606, 0.608, 0.61, 0.612, 0.614, 0.616, 0.618, 0.62, 0.622, 0.624, 0.626, 0.628, 0.63, 0.632, 0.634, 0.636, 0.638, 0.64, 0.642, 0.644, 0.646, 0.648, 0.65, 0.652, 0.654, 0.656, 0.658, 0.66, 0.662, 0.664, 0.666, 0.668, 0.67, 0.672, 0.674, 0.676, 0.678, 0.68, 0.682, 0.684, 0.686, 0.6880000000000001, 0.6900000000000001, 0.6920000000000001, 0.6940000000000001, 0.6960000000000001, 0.6980000000000001, 0.7000000000000001, 0.7020000000000001, 0.704, 0.706, 0.708, 0.71, 0.712, 0.714, 0.716, 0.718, 0.72, 0.722, 0.724, 0.726, 0.728, 0.73, 0.732, 0.734, 0.736, 0.738, 0.74, 0.742, 0.744, 0.746, 0.748, 0.75, 0.752, 0.754, 0.756, 0.758, 0.76, 0.762, 0.764, 0.766, 0.768, 0.77, 0.772, 0.774, 0.776, 0.778, 0.78, 0.782, 0.784, 0.786, 0.788, 0.79, 0.792, 0.794, 0.796, 0.798, 0.8, 0.802, 0.804, 0.806, 0.808, 0.81, 0.812, 0.8140000000000001, 0.8160000000000001, 0.8180000000000001, 0.8200000000000001, 0.8220000000000001, 0.8240000000000001, 0.8260000000000001, 0.8280000000000001, 0.8300000000000001, 0.8320000000000001, 0.834, 0.836, 0.838, 0.84, 0.842, 0.844, 0.846, 0.848, 0.85, 0.852, 0.854, 0.856, 0.858, 0.86, 0.862, 0.864, 0.866, 0.868, 0.87, 0.872, 0.874, 0.876, 0.878, 0.88, 0.882, 0.884, 0.886, 0.888, 0.89, 0.892, 0.894, 0.896, 0.898, 0.9, 0.902, 0.904, 0.906, 0.908, 0.91, 0.912, 0.914, 0.916, 0.918, 0.92, 0.922, 0.924, 0.926, 0.928, 0.93, 0.932, 0.934, 0.936, 0.9380000000000001, 0.9400000000000001, 0.9420000000000001, 0.9440000000000001, 0.9460000000000001, 0.9480000000000001, 0.9500000000000001, 0.9520000000000001, 0.9540000000000001, 0.9560000000000001, 0.9580000000000001, 0.96, 0.962, 0.964, 0.966, 0.968, 0.97, 0.972, 0.974, 0.976, 0.978, 0.98, 0.982, 0.984, 0.986, 0.988, 0.99, 0.992, 0.994, 0.996, 0.998, 1.0, 1.002, 1.004, 1.006, 1.008, 1.01, 1.012, 1.014, 1.016, 1.018, 1.02, 1.022, 1.024, 1.026, 1.028, 1.03, 1.032, 1.034, 1.036, 1.038, 1.04, 1.042, 1.044, 1.046, 1.048, 1.05, 1.052, 1.054, 1.056, 1.058, 1.06, 1.062, 1.064, 1.066, 1.068, 1.07, 1.072, 1.074, 1.076, 1.078, 1.08, 1.082, 1.084, 1.086, 1.088, 1.09, 1.092, 1.094, 1.096, 1.098, 1.1, 1.102, 1.104, 1.106, 1.108, 1.11, 1.112, 1.114, 1.116, 1.118, 1.12, 1.122, 1.124, 1.1260000000000001, 1.1280000000000001, 1.1300000000000001, 1.1320000000000001, 1.1340000000000001, 1.1360000000000001, 1.1380000000000001, 1.1400000000000001, 1.1420000000000001, 1.1440000000000001, 1.1460000000000001, 1.1480000000000001, 1.1500000000000001, 1.1520000000000001, 1.154, 1.156, 1.158, 1.16, 1.162, 1.164, 1.166, 1.168, 1.17, 1.172, 1.174, 1.176, 1.178, 1.18, 1.182, 1.184, 1.186, 1.188, 1.19, 1.192, 1.194, 1.196, 1.198, 1.2, 1.202, 1.204, 1.206, 1.208, 1.21, 1.212, 1.214, 1.216, 1.218, 1.22, 1.222, 1.224, 1.226, 1.228, 1.23, 1.232, 1.234, 1.236, 1.238, 1.24, 1.242, 1.244, 1.246, 1.248, 1.25, 1.252, 1.254, 1.256, 1.258, 1.26, 1.262, 1.264, 1.266, 1.268, 1.27, 1.272, 1.274, 1.276, 1.278, 1.28, 1.282, 1.284, 1.286, 1.288, 1.29, 1.292, 1.294, 1.296, 1.298, 1.3, 1.302, 1.304, 1.306, 1.308, 1.31, 1.312, 1.314, 1.316, 1.318, 1.32, 1.322, 1.324, 1.326, 1.328, 1.33, 1.332, 1.334, 1.336, 1.338, 1.34, 1.342, 1.344, 1.346, 1.348, 1.35, 1.352, 1.354, 1.356, 1.358, 1.36, 1.362, 1.364, 1.366, 1.368, 1.37, 1.372, 1.374, 1.3760000000000001, 1.3780000000000001, 1.3800000000000001, 1.3820000000000001, 1.3840000000000001, 1.3860000000000001, 1.3880000000000001, 1.3900000000000001, 1.3920000000000001, 1.3940000000000001, 1.3960000000000001, 1.3980000000000001, 1.4000000000000001, 1.4020000000000001, 1.4040000000000001, 1.4060000000000001, 1.408, 1.41, 1.412, 1.414, 1.416, 1.418, 1.42, 1.422, 1.424, 1.426, 1.428, 1.43, 1.432, 1.434, 1.436, 1.438, 1.44, 1.442, 1.444, 1.446, 1.448, 1.45, 1.452, 1.454, 1.456, 1.458, 1.46, 1.462, 1.464, 1.466, 1.468, 1.47, 1.472, 1.474, 1.476, 1.478, 1.48, 1.482, 1.484, 1.486, 1.488, 1.49, 1.492, 1.494, 1.496, 1.498, 1.5, 1.502, 1.504, 1.506, 1.508, 1.51, 1.512, 1.514, 1.516, 1.518, 1.52, 1.522, 1.524, 1.526, 1.528, 1.53, 1.532, 1.534, 1.536, 1.538, 1.54, 1.542, 1.544, 1.546, 1.548, 1.55, 1.552, 1.554, 1.556, 1.558, 1.56, 1.562, 1.564, 1.566, 1.568, 1.57, 1.572, 1.574, 1.576, 1.578, 1.58, 1.582, 1.584, 1.586, 1.588, 1.59, 1.592, 1.594, 1.596, 1.598, 1.6, 1.602, 1.604, 1.606, 1.608, 1.61, 1.612, 1.614, 1.616, 1.618, 1.62, 1.622, 1.624, 1.6260000000000001, 1.6280000000000001, 1.6300000000000001, 1.6320000000000001, 1.6340000000000001, 1.6360000000000001, 1.6380000000000001, 1.6400000000000001, 1.6420000000000001, 1.6440000000000001, 1.6460000000000001, 1.6480000000000001, 1.6500000000000001, 1.6520000000000001, 1.6540000000000001, 1.6560000000000001, 1.6580000000000001, 1.6600000000000001, 1.6620000000000001, 1.6640000000000001, 1.666, 1.668, 1.67, 1.672, 1.674, 1.676, 1.678, 1.68, 1.682, 1.684, 1.686, 1.688, 1.69, 1.692, 1.694, 1.696, 1.698, 1.7, 1.702, 1.704, 1.706, 1.708, 1.71, 1.712, 1.714, 1.716, 1.718, 1.72, 1.722, 1.724, 1.726, 1.728, 1.73, 1.732, 1.734, 1.736, 1.738, 1.74, 1.742, 1.744, 1.746, 1.748, 1.75, 1.752, 1.754, 1.756, 1.758, 1.76, 1.762, 1.764, 1.766, 1.768, 1.77, 1.772, 1.774, 1.776, 1.778, 1.78, 1.782, 1.784, 1.786, 1.788, 1.79, 1.792, 1.794, 1.796, 1.798, 1.8, 1.802, 1.804, 1.806, 1.808, 1.81, 1.812, 1.814, 1.816, 1.818, 1.82, 1.822, 1.824, 1.826, 1.828, 1.83, 1.832, 1.834, 1.836, 1.838, 1.84, 1.842, 1.844, 1.846, 1.848, 1.85, 1.852, 1.854, 1.856, 1.858, 1.86, 1.862, 1.864, 1.866, 1.868, 1.87, 1.872, 1.874, 1.8760000000000001, 1.8780000000000001, 1.8800000000000001, 1.8820000000000001, 1.8840000000000001, 1.8860000000000001, 1.8880000000000001, 1.8900000000000001, 1.8920000000000001, 1.8940000000000001, 1.8960000000000001, 1.8980000000000001, 1.9000000000000001, 1.9020000000000001, 1.9040000000000001, 1.9060000000000001, 1.9080000000000001, 1.9100000000000001, 1.9120000000000001, 1.9140000000000001, 1.9160000000000001, 1.9180000000000001, 1.92, 1.922, 1.924, 1.926, 1.928, 1.93, 1.932, 1.934, 1.936, 1.938, 1.94, 1.942, 1.944, 1.946, 1.948, 1.95, 1.952, 1.954, 1.956, 1.958, 1.96, 1.962, 1.964, 1.966, 1.968, 1.97, 1.972, 1.974, 1.976, 1.978, 1.98, 1.982, 1.984, 1.986, 1.988, 1.99, 1.992, 1.994, 1.996, 1.998, 2.0, 2.0020000000000002, 2.004, 2.0060000000000002, 2.008, 2.0100000000000002, 2.012, 2.0140000000000002};
    static final double[] REAL_SIGNAL2_Y = { 0.425, 0.425, 0.425, 0.43, 0.43, 0.43, 0.43, 0.43, 0.43, 0.43, 0.43, 0.425, 0.42, 0.42, 0.41500000000000004, 0.41500000000000004, 0.41500000000000004, 0.41500000000000004, 0.41500000000000004, 0.41500000000000004, 0.42, 0.42, 0.42, 0.42, 0.42, 0.425, 0.43, 0.435, 0.435, 0.435, 0.44, 0.445, 0.45, 0.455, 0.465, 0.47500000000000003, 0.515, 0.52, 0.54, 0.585, 0.615, 0.685, 0.77, 0.86, 0.9550000000000001, 1.1, 1.205, 1.24, 1.24, 1.11, 1.1, 1.095, 1.09, 0.9400000000000001, 0.8250000000000001, 0.73, 0.715, 0.71, 0.805, 0.675, 0.355, 0.32, 0.27, 0.245, 0.225, 0.225, 0.225, 0.23, 0.24, 0.255, 0.265, 0.28500000000000003, 0.3, 0.35000000000000003, 0.365, 0.38, 0.395, 0.41500000000000004, 0.435, 0.445, 0.455, 0.47500000000000003, 0.49, 0.505, 0.52, 0.525, 0.535, 0.54, 0.545, 0.555, 0.56, 0.5650000000000001, 0.5700000000000001, 0.5700000000000001, 0.5700000000000001, 0.5750000000000001, 0.5750000000000001, 0.5750000000000001, 0.58, 0.58, 0.585, 0.585, 0.59, 0.59, 0.59, 0.59, 0.595, 0.595, 0.595, 0.595, 0.6, 0.6, 0.605, 0.61, 0.615, 0.62, 0.62, 0.63, 0.64, 0.645, 0.65, 0.66, 0.665, 0.675, 0.685, 0.6950000000000001, 0.7000000000000001, 0.715, 0.72, 0.73, 0.74, 0.755, 0.77, 0.78, 0.795, 0.805, 0.8150000000000001, 0.835, 0.85, 0.865, 0.875, 0.88, 0.89, 0.905, 0.91, 0.92, 0.925, 0.935, 0.9500000000000001, 0.96, 0.97, 0.98, 0.995, 1.0050000000000001, 1.01, 1.0150000000000001, 1.02, 1.03, 1.035, 1.04, 1.045, 1.05, 1.05, 1.055, 1.06, 1.065, 1.065, 1.07, 1.075, 1.07, 1.07, 1.07, 1.07, 1.07, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.075, 1.08, 1.085, 1.085, 1.09, 1.09, 1.09, 1.095, 1.095, 1.095, 1.095, 1.1, 1.1, 1.105, 1.11, 1.115, 1.115, 1.115, 1.12, 1.12, 1.12, 1.125, 1.125, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.135, 1.135, 1.135, 1.1400000000000001, 1.1400000000000001, 1.1400000000000001, 1.145, 1.145, 1.1500000000000001, 1.1500000000000001, 1.155, 1.155, 1.16, 1.165, 1.165, 1.17, 1.17, 1.175, 1.175, 1.18, 1.18, 1.185, 1.185, 1.19, 1.19, 1.19, 1.19, 1.19, 1.19, 1.19, 1.185, 1.185, 1.185, 1.185, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.18, 1.175, 1.175, 1.175, 1.175, 1.17, 1.17, 1.17, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.17, 1.17, 1.17, 1.17, 1.17, 1.17, 1.17, 1.17, 1.17, 1.17, 1.17, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.18, 1.18, 1.18, 1.18, 1.185, 1.195, 1.2, 1.205, 1.22, 1.26, 1.28, 1.295, 1.34, 1.395, 1.485, 1.605, 1.665, 1.73, 1.745, 1.7650000000000001, 1.78, 1.79, 1.81, 1.845, 1.87, 1.895, 1.94, 2.025, 2.025, 2.025, 2.025, 2.02, 2.02, 2.0100000000000002, 2.0, 1.99, 1.82, 1.17, 1.125, 1.085, 1.055, 1.01, 1.0, 0.99, 0.985, 0.985, 0.985, 0.995, 1.0, 1.0150000000000001, 1.03, 1.04, 1.055, 1.08, 1.085, 1.1, 1.105, 1.125, 1.1300000000000001, 1.135, 1.1400000000000001, 1.145, 1.1500000000000001, 1.155, 1.155, 1.16, 1.16, 1.16, 1.16, 1.16, 1.16, 1.155, 1.155, 1.155, 1.155, 1.155, 1.155, 1.155, 1.155, 1.16, 1.16, 1.16, 1.165, 1.165, 1.165, 1.165, 1.165, 1.165, 1.17, 1.17, 1.175, 1.18, 1.18, 1.18, 1.185, 1.185, 1.19, 1.19, 1.19, 1.19, 1.195, 1.195, 1.195, 1.195, 1.205, 1.205, 1.21, 1.215, 1.22, 1.23, 1.23, 1.235, 1.24, 1.245, 1.2550000000000001, 1.26, 1.2650000000000001, 1.27, 1.28, 1.285, 1.29, 1.295, 1.3, 1.305, 1.305, 1.31, 1.315, 1.315, 1.32, 1.32, 1.32, 1.325, 1.325, 1.325, 1.325, 1.325, 1.325, 1.32, 1.32, 1.32, 1.315, 1.315, 1.315, 1.315, 1.305, 1.305, 1.3, 1.295, 1.285, 1.285, 1.2750000000000001, 1.27, 1.2650000000000001, 1.26, 1.2550000000000001, 1.25, 1.245, 1.24, 1.235, 1.23, 1.225, 1.22, 1.215, 1.21, 1.21, 1.205, 1.2, 1.195, 1.195, 1.19, 1.19, 1.185, 1.185, 1.18, 1.18, 1.18, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.175, 1.17, 1.17, 1.17, 1.175, 1.175, 1.175, 1.18, 1.185, 1.19, 1.195, 1.195, 1.2, 1.21, 1.215, 1.215, 1.215, 1.215, 1.22, 1.225, 1.225, 1.225, 1.225, 1.225, 1.225, 1.225, 1.23, 1.23, 1.23, 1.23, 1.225, 1.225, 1.225, 1.225, 1.22, 1.22, 1.22, 1.22, 1.22, 1.22, 1.215, 1.215, 1.21, 1.21, 1.205, 1.205, 1.2, 1.2, 1.195, 1.195, 1.195, 1.195, 1.195, 1.19, 1.19, 1.19, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.195, 1.19, 1.19, 1.19, 1.195, 1.195, 1.195, 1.195, 1.195, 1.2, 1.205, 1.21, 1.215, 1.225, 1.24, 1.25, 1.28, 1.315, 1.36, 1.3900000000000001, 1.465, 1.565, 1.7, 1.7750000000000001, 1.935, 2.05, 2.11, 2.185, 2.185, 2.18, 2.11, 2.035, 1.905, 1.87, 1.87, 1.87, 1.75, 1.315, 1.3, 1.29, 1.2750000000000001, 1.2650000000000001, 1.205, 1.155, 1.095, 1.07, 1.05, 1.03, 1.0150000000000001, 1.0, 1.0, 1.0, 1.01, 1.02, 1.03, 1.04, 1.045, 1.05, 1.06, 1.07, 1.08, 1.09, 1.1, 1.11, 1.12, 1.125, 1.125, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.135, 1.135, 1.135, 1.135, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.1300000000000001, 1.135, 1.135, 1.135, 1.135, 1.1400000000000001, 1.1400000000000001, 1.1400000000000001, 1.145, 1.145, 1.1500000000000001, 1.1500000000000001, 1.155, 1.155, 1.16, 1.165, 1.165, 1.17, 1.17, 1.175, 1.175, 1.18, 1.18, 1.185, 1.185, 1.19, 1.19, 1.195, 1.2, 1.205, 1.21, 1.215, 1.215, 1.22, 1.23, 1.235, 1.24, 1.245, 1.25, 1.25, 1.26, 1.2650000000000001, 1.2650000000000001, 1.27, 1.2750000000000001, 1.2750000000000001, 1.28, 1.285, 1.285, 1.29, 1.29, 1.29, 1.29, 1.29, 1.29, 1.29, 1.29, 1.285, 1.28, 1.2750000000000001, 1.27, 1.27, 1.2650000000000001, 1.26, 1.2550000000000001, 1.25, 1.245, 1.235, 1.225, 1.215, 1.21, 1.205, 1.195, 1.19, 1.185, 1.175, 1.17, 1.165, 1.16, 1.155, 1.1500000000000001, 1.145, 1.135, 1.1300000000000001, 1.125, 1.12, 1.115, 1.11, 1.105, 1.1, 1.095, 1.09, 1.085, 1.08, 1.08, 1.075, 1.075, 1.07, 1.065, 1.06, 1.055, 1.055, 1.05, 1.045, 1.04, 1.035, 1.03, 1.025, 1.02, 1.0150000000000001, 1.01, 1.01, 1.0050000000000001, 1.0, 0.995, 0.99, 0.985, 0.98, 0.98, 0.975, 0.975, 0.975, 0.97, 0.97, 0.97, 0.97, 0.97, 0.97, 0.965, 0.96, 0.9550000000000001, 0.9550000000000001, 0.9550000000000001, 0.9500000000000001, 0.9450000000000001, 0.9400000000000001, 0.935, 0.93, 0.925, 0.92, 0.91, 0.905, 0.9, 0.89, 0.885, 0.88, 0.87, 0.865, 0.86, 0.855, 0.845, 0.84, 0.8300000000000001, 0.8250000000000001, 0.8150000000000001, 0.81, 0.8, 0.795, 0.79, 0.78, 0.775, 0.77, 0.76, 0.755, 0.745, 0.74, 0.735, 0.725, 0.725, 0.715, 0.715, 0.71, 0.705, 0.705, 0.6950000000000001, 0.6950000000000001, 0.6900000000000001, 0.6900000000000001, 0.68, 0.68, 0.675, 0.67, 0.665, 0.665, 0.66, 0.655, 0.65, 0.645, 0.64, 0.635, 0.63, 0.625, 0.62, 0.615, 0.61, 0.605, 0.6, 0.595, 0.59, 0.585, 0.58, 0.58, 0.5750000000000001, 0.5700000000000001, 0.5650000000000001, 0.5650000000000001, 0.56, 0.56, 0.56, 0.56, 0.56, 0.5650000000000001, 0.5700000000000001, 0.5700000000000001, 0.585, 0.615, 0.645, 0.7000000000000001, 0.765, 0.88, 1.0, 1.06, 1.08, 1.105, 1.135, 1.1500000000000001, 1.18, 1.285, 1.28, 1.28, 1.2, 1.16, 1.105, 1.09, 1.05, 1.035, 0.935, 0.535, 0.47000000000000003, 0.41500000000000004, 0.36, 0.33, 0.295, 0.27, 0.245, 0.23, 0.22, 0.215, 0.215, 0.215, 0.225, 0.23500000000000001, 0.25, 0.26, 0.265, 0.28500000000000003, 0.31, 0.325, 0.335, 0.34500000000000003, 0.36, 0.375, 0.38, 0.385, 0.395, 0.395, 0.4, 0.4, 0.4, 0.4, 0.405, 0.405, 0.405, 0.405, 0.4, 0.4, 0.4, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.395, 0.4, 0.4, 0.4, 0.4, 0.405, 0.41000000000000003, 0.41000000000000003, 0.41500000000000004, 0.41500000000000004, 0.42, 0.42, 0.42, 0.425, 0.425, 0.43, 0.43, 0.43, 0.435, 0.44, 0.44, 0.45, 0.465, 0.465, 0.47500000000000003, 0.485, 0.485, 0.5, 0.505, 0.515, 0.52, 0.52, 0.525, 0.525, 0.53, 0.535, 0.535, 0.535, 0.535, 0.535, 0.535, 0.54, 0.54, 0.54, 0.54, 0.54, 0.525, 0.525, 0.525, 0.52, 0.52, 0.515, 0.51, 0.505, 0.5};


    static final double[] SIMPLE_SIGNAL_X = {0. ,   0.1,   0.2,   0.3,   0.4,
                                             0.5,   0.6,   0.7,   0.8,   0.9,
                                             1. ,   1.1,   1.2,   1.3,   1.4,
                                             1.5,   1.6,   1.7,   1.8,   1.9};

    static final double[] SIMPLE_SIGNAL_Y = {0.12,  0.77,  0.67,  0.75,  0.72,
                                             0.65,  0.51,  0.74,  0.93,  0.01,
                                             0.38,  0.18,  0.31,  0.88,  0.51,
                                             0.32,  0.16,  0.25,  0.81,  0.21};
    public static final int REAL_SIGNAL_LEN = 688;
    public static final int SIMPLE_SIGNAL_LEN = 20;
    private static final int SIMPLE_SIGNAL_PEAKS_LEN = 6;
    private static final int SIMPLE_SIGNAL_DEPRESSIONS_LEN = 7;
    private static final Integer[] SIMPLE_SIGNAL_PEAKS_POS = {1, 3, 8, 10, 13, 18};
    private static final Integer[] SIMPLE_SIGNAL_DEPRESSIONS_POS = {0, 2, 6, 9, 11, 16, 19};

    private static final Integer[] REAL_SIGNAL_ALL_PEAKS_POS = {1, 33, 52, 81, 198, 291, 301, 342, 362, 404, 427, 461, 482, 508, 629};
    private static final Integer[] REAL_SIGNAL_ACUTE_PEAKS_POS = {81, 198, 342, 508, 629};
    private static final Integer[] REAL_SIGNAL_R_PEEKS_POS = {81, 508};
    private static final Integer[] REAL_SIGNAL_T_PEEKS_POS = {198, 629};

    private static final Integer[] REAL_SIGNAL2_ACUTE_PEAKS_POS = {47, 334, 439, 609, 715, 890, 996};
    private static final Integer[] REAL_SIGNAL2_R_PEEKS_POS = {47, 334, 609, 890};
    private static final Integer[] REAL_SIGNAL2_T_PEEKS_POS = {439, 715, 996};

    EkgExaminer eSimple;
    EkgExaminer eReal;
    EkgExaminer eReal2;

    @Before
    public void ekgExaminer_setup() {
        eReal = new EkgExaminer(REAL_SIGNAL_X, REAL_SIGNAL_Y);
        eReal2 = new EkgExaminer(REAL_SIGNAL2_X, REAL_SIGNAL2_Y);
        eSimple = new EkgExaminer(SIMPLE_SIGNAL_X, SIMPLE_SIGNAL_Y);
    }

    @Test
    public void ekgExaminer_testArrays() {
        Assert.assertEquals(REAL_SIGNAL_X.length, REAL_SIGNAL_LEN);
        Assert.assertEquals(REAL_SIGNAL_Y.length, REAL_SIGNAL_LEN);
        Assert.assertEquals(SIMPLE_SIGNAL_X.length, SIMPLE_SIGNAL_LEN);
        Assert.assertEquals(SIMPLE_SIGNAL_Y.length, SIMPLE_SIGNAL_LEN);
    }

    @Test
    public void ekgExaminer_SampleSignal_testPeaks() {
        LinkedList<Integer> peaks = eSimple.getPeaksPositions();
        Assert.assertArrayEquals(SIMPLE_SIGNAL_PEAKS_POS, peaks.toArray());
    }

    @Test
    public void ekgExaminer_SampleSignal_testDepressions() {
        LinkedList<Integer> peaks = eSimple.getDepressionsPositions();
        Assert.assertArrayEquals(SIMPLE_SIGNAL_DEPRESSIONS_POS, peaks.toArray());
    }

    @Test
    public void ekgExaminer_RealEKG_testPeaks() {
        LinkedList<Integer> peaks;
        peaks = eReal.getPeaksPositions();
        Assert.assertArrayEquals(REAL_SIGNAL_ALL_PEAKS_POS, peaks.toArray());
    }

    @Test
    public void ekgExaminer_RealEKG_testAcutePeaks() {
        LinkedList<Integer> peaks;
        peaks = eReal.getAcutePeaksPositions();
        Assert.assertArrayEquals(REAL_SIGNAL_ACUTE_PEAKS_POS, peaks.toArray());
    }

    @Test
    public void ekgExaminer_RealEKG2_testAcutePeaks() {
        LinkedList<Integer> peaks;
        peaks = eReal2.getAcutePeaksPositions();
        Assert.assertArrayEquals(REAL_SIGNAL2_ACUTE_PEAKS_POS, peaks.toArray());
    }

    @Test
    public void ekgExaminer_RealEKG_testFrequency() {
        double frequency = eReal.getFrequency();
        double expected_using_r = 60/(REAL_SIGNAL_X[REAL_SIGNAL_R_PEEKS_POS[1]] - REAL_SIGNAL_X[REAL_SIGNAL_R_PEEKS_POS[0]]);
        double expected_using_t = 60/(REAL_SIGNAL_X[REAL_SIGNAL_T_PEEKS_POS[1]] - REAL_SIGNAL_X[REAL_SIGNAL_T_PEEKS_POS[0]]);

        double expected = StatUtils.mean(new double[] {expected_using_r, expected_using_t});
        double delta = Math.abs(expected_using_r - expected_using_t);
        Assert.assertEquals(expected, frequency, delta);
    }

    @Test
    public void ekgExaminer_RealEKG2_testFrequency() {
        double frequency = eReal2.getFrequency();
        double expected_using_r = 60/(REAL_SIGNAL2_X[REAL_SIGNAL2_R_PEEKS_POS[1]] - REAL_SIGNAL2_X[REAL_SIGNAL2_R_PEEKS_POS[0]]);
        double expected_using_t = 60/(REAL_SIGNAL2_X[REAL_SIGNAL2_T_PEEKS_POS[1]] - REAL_SIGNAL2_X[REAL_SIGNAL2_T_PEEKS_POS[0]]);

        double expected = StatUtils.mean(new double[] {expected_using_r, expected_using_t});
        double delta = Math.abs(expected_using_r - expected_using_t);
        Assert.assertEquals(expected, frequency, delta);
    }

}
